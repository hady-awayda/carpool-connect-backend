generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// Enums
enum UserRolesEnum {
  user
  admin
}

enum RideUserTypeEnum {
  rider
  passenger
  partnership
}

enum UserRelationshipsStatusEnum {
  requested
  approved
  declined
  active
  ended
}

// Models
model User {
  id             Int      @id @default(autoincrement())
  name           String   @db.VarChar(255)
  email          String   @unique
  password       String   @db.VarChar(255)
  role           UserRolesEnum @default(user)
  phoneNumber    String?  @db.VarChar(20)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  deletedAt      DateTime?
  createdBy      Int?
  updatedBy      Int?
  deletedBy      Int?

  // Relationships
  rideSchedules  RideSchedule[]
}

model RideSchedule {
  id              Int      @id @default(autoincrement())
  userId          Int
  rideUserType    RideUserTypeEnum @default(rider)
  departureLat    Float
  departureLng    Float
  destinationLat  Float
  destinationLng  Float
  departureTime   DateTime
  arrivalTime     DateTime
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  deletedAt       DateTime?

  // Foreign Keys
  user            User     @relation(fields: [userId], references: [id])
}

model UserMatch {
  id             Int      @id @default(autoincrement())
  userId1        Int
  userId2        Int
  status         UserRelationshipsStatusEnum @default(requested)
  requestedBy    Int
  responseBy     Int?
  requestedAt    DateTime @default(now())
  approvedAt     DateTime?
  updatedAt      DateTime @updatedAt

  user1          User @relation("User1", fields: [userId1], references: [id])
  user2          User @relation("User2", fields: [userId2], references: [id])
}
